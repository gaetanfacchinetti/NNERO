

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nnero package &mdash; NNERO 0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=7026087e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="nnero" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NNERO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">nnero</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">nnero package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.astrophysics">nnero.astrophysics module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.astrophysics.dmhalo_dmuv"><code class="docutils literal notranslate"><span class="pre">dmhalo_dmuv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.astrophysics.f_duty"><code class="docutils literal notranslate"><span class="pre">f_duty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.astrophysics.m_halo"><code class="docutils literal notranslate"><span class="pre">m_halo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.astrophysics.phi_uv"><code class="docutils literal notranslate"><span class="pre">phi_uv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.classifier">nnero.classifier module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.classifier.Classifier"><code class="docutils literal notranslate"><span class="pre">Classifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.classifier.train_classifier"><code class="docutils literal notranslate"><span class="pre">train_classifier()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.constants">nnero.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.cosmology">nnero.cosmology module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.Cosmology"><code class="docutils literal notranslate"><span class="pre">Cosmology</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.ParamsDefault"><code class="docutils literal notranslate"><span class="pre">ParamsDefault</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.ShortPowerSpectrumRange"><code class="docutils literal notranslate"><span class="pre">ShortPowerSpectrumRange</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.check_ik_R"><code class="docutils literal notranslate"><span class="pre">check_ik_R()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.convert_array"><code class="docutils literal notranslate"><span class="pre">convert_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.dn_dm"><code class="docutils literal notranslate"><span class="pre">dn_dm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.dsigma_m_dm"><code class="docutils literal notranslate"><span class="pre">dsigma_m_dm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.dsigma_r_dr"><code class="docutils literal notranslate"><span class="pre">dsigma_r_dr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.growth_function"><code class="docutils literal notranslate"><span class="pre">growth_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.h_factor_no_rad"><code class="docutils literal notranslate"><span class="pre">h_factor_no_rad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.h_factor_numpy"><code class="docutils literal notranslate"><span class="pre">h_factor_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.n_baryons"><code class="docutils literal notranslate"><span class="pre">n_baryons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.n_ur"><code class="docutils literal notranslate"><span class="pre">n_ur()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.omega_nu"><code class="docutils literal notranslate"><span class="pre">omega_nu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.omega_r"><code class="docutils literal notranslate"><span class="pre">omega_r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.optical_depth_no_rad"><code class="docutils literal notranslate"><span class="pre">optical_depth_no_rad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.optical_depth_numpy"><code class="docutils literal notranslate"><span class="pre">optical_depth_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.rho_baryons"><code class="docutils literal notranslate"><span class="pre">rho_baryons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.sigma_m"><code class="docutils literal notranslate"><span class="pre">sigma_m()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.cosmology.sigma_r"><code class="docutils literal notranslate"><span class="pre">sigma_r()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.data">nnero.data module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.DataPartition"><code class="docutils literal notranslate"><span class="pre">DataPartition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.DataSet"><code class="docutils literal notranslate"><span class="pre">DataSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.MetaData"><code class="docutils literal notranslate"><span class="pre">MetaData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.TorchDataset"><code class="docutils literal notranslate"><span class="pre">TorchDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.label_to_plot"><code class="docutils literal notranslate"><span class="pre">label_to_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.preprocess_raw_data"><code class="docutils literal notranslate"><span class="pre">preprocess_raw_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.true_to_uniform"><code class="docutils literal notranslate"><span class="pre">true_to_uniform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.data.uniform_to_true"><code class="docutils literal notranslate"><span class="pre">uniform_to_true()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.mcmc">nnero.mcmc module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.mcmc.initialise_walkers"><code class="docutils literal notranslate"><span class="pre">initialise_walkers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.mcmc.log_likelihood"><code class="docutils literal notranslate"><span class="pre">log_likelihood()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.mcmc.log_prior"><code class="docutils literal notranslate"><span class="pre">log_prior()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.mcmc.log_probability"><code class="docutils literal notranslate"><span class="pre">log_probability()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.network">nnero.network module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.network.NeuralNetwork"><code class="docutils literal notranslate"><span class="pre">NeuralNetwork</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.predictor">nnero.predictor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.check_values"><code class="docutils literal notranslate"><span class="pre">check_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.input_values"><code class="docutils literal notranslate"><span class="pre">input_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_classifier"><code class="docutils literal notranslate"><span class="pre">predict_classifier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_classifier_numpy"><code class="docutils literal notranslate"><span class="pre">predict_classifier_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_regressor"><code class="docutils literal notranslate"><span class="pre">predict_regressor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_regressor_numpy"><code class="docutils literal notranslate"><span class="pre">predict_regressor_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_tau"><code class="docutils literal notranslate"><span class="pre">predict_tau()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_tau_from_xHII"><code class="docutils literal notranslate"><span class="pre">predict_tau_from_xHII()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_tau_from_xHII_numpy"><code class="docutils literal notranslate"><span class="pre">predict_tau_from_xHII_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_tau_numpy"><code class="docutils literal notranslate"><span class="pre">predict_tau_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_xHII"><code class="docutils literal notranslate"><span class="pre">predict_xHII()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.predict_xHII_numpy"><code class="docutils literal notranslate"><span class="pre">predict_xHII_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.uniform_input_array"><code class="docutils literal notranslate"><span class="pre">uniform_input_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.predictor.uniform_input_values"><code class="docutils literal notranslate"><span class="pre">uniform_input_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero.regressor">nnero.regressor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nnero.regressor.Regressor"><code class="docutils literal notranslate"><span class="pre">Regressor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#nnero.regressor.train_regressor"><code class="docutils literal notranslate"><span class="pre">train_regressor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-nnero">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NNERO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">nnero</a></li>
      <li class="breadcrumb-item active">nnero package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/nnero.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nnero-package">
<h1>nnero package<a class="headerlink" href="#nnero-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-nnero.astrophysics">
<span id="nnero-astrophysics-module"></span><h2>nnero.astrophysics module<a class="headerlink" href="#module-nnero.astrophysics" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nnero.astrophysics.dmhalo_dmuv">
<span class="sig-prename descclassname"><span class="pre">nnero.astrophysics.</span></span><span class="sig-name descname"><span class="pre">dmhalo_dmuv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_uv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_star10</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/astrophysics.html#dmhalo_dmuv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.astrophysics.dmhalo_dmuv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.astrophysics.f_duty">
<span class="sig-prename descclassname"><span class="pre">nnero.astrophysics.</span></span><span class="sig-name descname"><span class="pre">f_duty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_turn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/astrophysics.html#f_duty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.astrophysics.f_duty" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.astrophysics.m_halo">
<span class="sig-prename descclassname"><span class="pre">nnero.astrophysics.</span></span><span class="sig-name descname"><span class="pre">m_halo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_uv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_star10</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/astrophysics.html#m_halo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.astrophysics.m_halo" title="Link to this definition"></a></dt>
<dd><p>Halo mass in term of the UV magnitude for a given astrophysical model</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>hz: float, np.ndarray</dt><dd><p>shape (q, r). Hubble factor given in s^{-1}</p>
</dd>
</dl>
</li>
</ul>
<p>m_uv: float, np.ndarry (s,) or (r, s)
omega_b: float, np.ndaray (q,)</p>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<p>result of shape (q, r, s)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.astrophysics.phi_uv">
<span class="sig-prename descclassname"><span class="pre">nnero.astrophysics.</span></span><span class="sig-name descname"><span class="pre">phi_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_uv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_star10</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_turn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.322</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/astrophysics.html#phi_uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.astrophysics.phi_uv" title="Link to this definition"></a></dt>
<dd><p>UV flux in Mpc^{-3}</p>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>m_uv: float, np.ndarry (s,)
omega_b: float, np.ndaray (q,)</p>
</section>
<section id="id2">
<h3>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>result of shape (q, r, s)</p>
</section>
</dd></dl>

</section>
<section id="module-nnero.classifier">
<span id="nnero-classifier-module"></span><h2>nnero.classifier module<a class="headerlink" href="#module-nnero.classifier" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nnero.classifier.Classifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.classifier.</span></span><span class="sig-name descname"><span class="pre">Classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/classifier.html#Classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.classifier.Classifier" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#nnero.network.NeuralNetwork" title="nnero.network.NeuralNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralNetwork</span></code></a></p>
<p>This is <a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Classifier</span></code></a>, a daughter class of <code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralNetwork</span></code> specialised for classifier</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">name</span></span></dt>
<dd><p>the name of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">metadata</span></span></dt>
<dd><p>metadata on which the model is trained</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metadata</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">partition</span></span></dt>
<dd><p>partitioning of the data on which the model is trained</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnero.data.DataPartition" title="nnero.data.DataPartition">DataPartition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">train_loss</span></span></dt>
<dd><p>1D array training loss for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">valid_loss</span></span></dt>
<dd><p>1D array validation losses for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">train_accuracy</span></span></dt>
<dd><p>1D array training accuracy for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">valid_accuracy</span></span></dt>
<dd><p>1D array validation accuracy for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">save(path=&quot;.&quot;,</span> <span class="pre">save_partition=True)</span></span></dt>
<dd><p>save the neural network</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">-</span> <span class="pre">load_weights_and_extras(path)</span></span></dt>
<dd><p>load the weights and extra available info on the network</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.classifier.Classifier.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/classifier.html#Classifier.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.classifier.Classifier.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.classifier.Classifier.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/gaetanfacchinetti/Documents/work/projects/MatterPS21cm/mps21cm/NNERO/src/nnero/nn_data/DefaultClassifier'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/classifier.html#Classifier.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.classifier.Classifier.load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.classifier.Classifier.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/classifier.html#Classifier.test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.classifier.Classifier.test" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.classifier.train_classifier">
<span class="sig-prename descclassname"><span class="pre">nnero.classifier.</span></span><span class="sig-name descname"><span class="pre">train_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/classifier.html#train_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.classifier.train_classifier" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nnero.constants">
<span id="nnero-constants-module"></span><h2>nnero.constants module<a class="headerlink" href="#module-nnero.constants" title="Link to this heading"></a></h2>
</section>
<section id="module-nnero.cosmology">
<span id="nnero-cosmology-module"></span><h2>nnero.cosmology module<a class="headerlink" href="#module-nnero.cosmology" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nnero.cosmology.Cosmology">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">Cosmology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#Cosmology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.Cosmology" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#nnero.cosmology.ParamsDefault" title="nnero.cosmology.ParamsDefault"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsDefault</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="nnero.cosmology.Cosmology.omega_nu">
<span class="sig-name descname"><span class="pre">omega_nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#Cosmology.omega_nu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.Cosmology.omega_nu" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnero.cosmology.ParamsDefault">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">ParamsDefault</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#ParamsDefault"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.ParamsDefault" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nnero.cosmology.ParamsDefault.create_params">
<span class="sig-name descname"><span class="pre">create_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#ParamsDefault.create_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.ParamsDefault.create_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.cosmology.ParamsDefault.set_defaults">
<span class="sig-name descname"><span class="pre">set_defaults</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#ParamsDefault.set_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.ParamsDefault.set_defaults" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.cosmology.ParamsDefault.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">new_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#ParamsDefault.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.ParamsDefault.update" title="Link to this definition"></a></dt>
<dd><p>update parameters</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="nnero.cosmology.ShortPowerSpectrumRange">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">ShortPowerSpectrumRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Matter</span> <span class="pre">power</span> <span class="pre">spectrum</span> <span class="pre">range</span> <span class="pre">is</span> <span class="pre">too</span> <span class="pre">short'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#ShortPowerSpectrumRange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.ShortPowerSpectrumRange" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised for short exceptions</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.cosmology.ShortPowerSpectrumRange.message">
<span class="sig-name descname"><span class="pre">message</span></span><a class="headerlink" href="#nnero.cosmology.ShortPowerSpectrumRange.message" title="Link to this definition"></a></dt>
<dd><p>explanation of the error</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.check_ik_R">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">check_ik_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ik_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#check_ik_R"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.check_ik_R" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.convert_array">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">convert_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_torch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#convert_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.convert_array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.dn_dm">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">dn_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.322</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheth_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#dn_dm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.dn_dm" title="Link to this definition"></a></dt>
<dd><p>Halo mass function in Msol^{-1} Mpc^{-3}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>-</em>) – shape (r,) redshift values</p></li>
<li><p><strong>mass</strong> (<em>-</em>) – shape (s,) or (q, r, s,) mass scale in Msol</p></li>
<li><p><strong>k</strong> (<em>-</em>) – shape (q, p), modes in Mpc^{-1}</p></li>
<li><p><strong>pk</strong> (<em>-</em>) – shape (q, p), power spectrum in Mpc^3</p></li>
<li><p><strong>omega_m</strong> (<em>-</em>) – shape (q,)</p></li>
<li><p><strong>window</strong> (<em>-</em>) – smoothing function</p></li>
<li><p><strong>ik_radius</strong> (<em>-</em>) – shape of radius, indices of the k array corresponding to k = 1/radius</p></li>
<li><p><strong>c</strong> (<em>-</em>) – conversion factor for the mass in the sharpk window function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- res</strong> – shape (q, r, s) in Msol / Mpc^3</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarrray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.dsigma_m_dm">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">dsigma_m_dm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#dsigma_m_dm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.dsigma_m_dm" title="Link to this definition"></a></dt>
<dd><p>Derivative of the standard deviation of the matter power spectrum
on mass scale. Note that all physical dimensions must be self consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>-</em>) – shape (q1, …, qn, r1, …, rm, s) mass scale in Msol</p></li>
<li><p><strong>k</strong> (<em>-</em>) – shape (q1, …, qn, p), modes in Mpc^{-1}</p></li>
<li><p><strong>pk</strong> (<em>-</em>) – shape (q1, …, qn, p), power spectrum in Mpc^3</p></li>
<li><p><strong>omega_m</strong> (<em>-</em>) – shape (q1, …, qn)</p></li>
<li><p><strong>window</strong> (<em>-</em>) – smoothing function</p></li>
<li><p><strong>ik_radius</strong> (<em>-</em>) – shape of radius, indices of the k array corresponding to k = 1/radius</p></li>
<li><p><strong>c</strong> (<em>-</em>) – conversion factor for the mass in the sharpk window function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- d smoothed sigma / dm</strong> – shape (q1, …, qn, r1, …, rm, s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray in Msol^{-1}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.dsigma_r_dr">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">dsigma_r_dr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#dsigma_r_dr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.dsigma_r_dr" title="Link to this definition"></a></dt>
<dd><p>Derivative of the standard deviation of the matter power spectrum
inside <cite>radius</cite>. Note that all physical dimensions must be self consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>-</em>) – shape (q1, …, qn, r1, …, rm, s), smoothing scale r in Mpc</p></li>
<li><p><strong>k</strong> (<em>-</em>) – shape (q1, …, qn, p), modes in Mpc^{-1}</p></li>
<li><p><strong>pk</strong> (<em>-</em>) – shape (q1, …, qn, p), power spectrum in Mpc^3</p></li>
<li><p><strong>window</strong> (<em>-</em>) – smoothing function</p></li>
<li><p><strong>ik_radius</strong> (<em>-</em>) – shape of radius, indices of the k array corresponding to k = 1/radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- d smoothed sigma / dr</strong> – shape (q1, …, qn, r1, …, rm, s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray in Mpc^{-1}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.growth_function">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">growth_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#growth_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.growth_function" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape (q1, …, qn, r)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.h_factor_no_rad">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">h_factor_no_rad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#h_factor_no_rad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.h_factor_no_rad" title="Link to this definition"></a></dt>
<dd><p>E(z) = H(z) / H0 without radiation</p>
<p>Efficient evalutation of hubble rate parameters for numpy arrays
or torch tensors (also works with simple float ). In the first
case the shape of these numpy arrays must be compatible (see below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>-</em>) – shape (p, ) if array, redshift range</p></li>
<li><p><strong>omega_b</strong> (<em>-</em>) – shape (q1,…, qn) if array, reduced abundance of baryons (i.e. times h^2)</p></li>
<li><p><strong>omega_c</strong> (<em>-</em>) – shape (q1,…, qn) if array, reduced abundance of dark matter (i.e. times h^2)</p></li>
<li><p><strong>h</strong> (<em>-</em>) – shape (q1,…, qn) if array, Hubble factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- E(z)</strong> – shape (q1,…, qn, p), hubble factor E(z) = H(z) / H0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray | torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.h_factor_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">h_factor_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_nus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#h_factor_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.h_factor_numpy" title="Link to this definition"></a></dt>
<dd><p>E(z) = H(z) / H0 with radiation</p>
<p>Efficient evalutation of hubble rate parameters for numpy arrays
or torch tensors (also works with simple float ). In the first
case the shape of these numpy arrays must be compatible (see below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>-</em>) – shape (p, ) if array, redshift range</p></li>
<li><p><strong>omega_b</strong> (<em>-</em>) – shape (q1,…, qn) if array, reduced abundance of baryons (i.e. times h^2)</p></li>
<li><p><strong>omega_c</strong> (<em>-</em>) – shape (q1,…, qn) if array, reduced abundance of dark matter (i.e. times h^2)</p></li>
<li><p><strong>h</strong> (<em>-</em>) – shape (q1,…, qn) if array,, Hubble factor</p></li>
<li><p><strong>mnus</strong> (<em>-</em>) – shape (q1,…, qn, 3) if array or at least shape (, 3), mass of the neutrinos</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- E(z)</strong> – shape (q1,…, qn, p), hubble factor E(z) = H(z) / H0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray | torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.n_baryons">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">n_baryons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#n_baryons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.n_baryons" title="Link to this definition"></a></dt>
<dd><p>baryon number density (in 1 / m^3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>omega_b</strong> (<em>float</em><em> | </em><em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – reduced abundance of baryons (i.e. times h^2)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float or np.ndarray or torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.n_ur">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">n_ur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_nus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#n_ur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.n_ur" title="Link to this definition"></a></dt>
<dd><p>number of ultra-relativistic degrees of freedom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m_nus</strong> (<em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – shape (q1, q2, …, qn, 3), mass of the three neutrinos
in a given model</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray | torch.Tenso with shape (q1, q2, …, qn)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.omega_nu">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">omega_nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_nus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#omega_nu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.omega_nu" title="Link to this definition"></a></dt>
<dd><p>Efficient implementation of reduced neutrino abundance for numpy arrays.
Parameters must be floats, arrays or tensor with compatible dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_nus</strong> (<em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – shape (q1, q2, …, qn, 3), mass of the three neutrinos
in a given model</p></li>
<li><p><strong>z</strong> (<em>float</em><em> | </em><em>numpy.ndarray</em><em> | </em><em>torch.Tensor</em>) – shape (p, ) if array, redshift range</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray | torch.Tensor with shape (q1, …, qn, p)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.omega_r">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">omega_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_nus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#omega_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.omega_r" title="Link to this definition"></a></dt>
<dd><p>reduced abundance of radiation today</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m_nus</strong> (<em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – shape (q1, q2, …, qn, 3), mass of the three neutrinos
in a given model</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray | torch.Tensor with shape (q1, q2, …, qn)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.optical_depth_no_rad">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">optical_depth_no_rad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xHII</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#optical_depth_no_rad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.optical_depth_no_rad" title="Link to this definition"></a></dt>
<dd><p>Efficient evaluation of the opetical depth to reionization
optical depth to reionization (dimensionless)
uses fast numpy operations with trapezoid rule
(assume that radiation is neglibible on the range of z)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>-</em>) – shape (p,) if array, redshift range</p></li>
<li><p><strong>xHII</strong> (<em>-</em>) – shape (n, p), ionization fraction vs the redshift for the n models</p></li>
<li><p><strong>omega_b</strong> (<em>-</em>) – shape (n,) if array, reduced abundance of baryons (i.e. times h^2)</p></li>
<li><p><strong>omega_c</strong> (<em>-</em>) – shape (n,) if array, reduced abundance of dark matter (i.e. times h^2)</p></li>
<li><p><strong>h</strong> (<em>-</em>) – shape (n,) if array, Hubble factor</p></li>
<li><p><strong>low_value</strong> (<em>-</em>) – value of xHII at redshift smaller than min(z)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- optical depth</strong> – shape(n, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray | torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.optical_depth_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">optical_depth_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xHII</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_nus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#optical_depth_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.optical_depth_numpy" title="Link to this definition"></a></dt>
<dd><p>Efficient evaluation of the opetical depth to reionization
optical depth to reionization (dimensionless)
uses fast numpy operations with trapezoid rule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>-</em>) – shape (p,) if array, redshift range</p></li>
<li><p><strong>xHII</strong> (<em>-</em>) – shape (n, p), ionization fraction vs the redshift for the n models</p></li>
<li><p><strong>omega_b</strong> (<em>-</em>) – shape (n,) if array, reduced abundance of baryons (i.e. times h^2)</p></li>
<li><p><strong>omega_c</strong> (<em>-</em>) – shape (n,) if array, reduced abundance of dark matter (i.e. times h^2)</p></li>
<li><p><strong>h</strong> (<em>-</em>) – shape (n,) if array, Hubble factor</p></li>
<li><p><strong>m_nus</strong> (<em>-</em>) – shape (n, 3), mass of the three neutrinos in a given model</p></li>
<li><p><strong>low_value</strong> (<em>-</em>) – value of xHII at redshift smaller than min(z)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- optical depth</strong> – shape(n, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray | torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.rho_baryons">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">rho_baryons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/nnero/cosmology.html#rho_baryons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.rho_baryons" title="Link to this definition"></a></dt>
<dd><p>baryon energy density (in eV / m^3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>omega_b</strong> (<em>float</em><em> | </em><em>np.ndarray</em><em> | </em><em>torch.Tensor</em>) – reduced abundance of baryons (i.e. times h^2)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float or np.ndarray or torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.sigma_m">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">sigma_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ik_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#sigma_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.sigma_m" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the matter power spectrum on mass scale.
Note that all physical dimensions must be self consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mass</strong> (<em>-</em>) – shape (q1, …, qn, r1, …, rm, s) mass scale in Msol</p></li>
<li><p><strong>k</strong> (<em>-</em>) – shape (q1, …, qn, p), modes in Mpc^{-1}</p></li>
<li><p><strong>pk</strong> (<em>-</em>) – shape (q1, …, qn, p), power spectrum in Mpc^3</p></li>
<li><p><strong>omega_m</strong> (<em>-</em>) – shape (q1, …, qn)</p></li>
<li><p><strong>window</strong> (<em>-</em>) – smoothing function</p></li>
<li><p><strong>ik_radius</strong> (<em>-</em>) – shape of radius, indices of the k array corresponding to k = 1/radius</p></li>
<li><p><strong>c</strong> (<em>-</em>) – conversion factor for the mass in the sharpk window function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- smoothed sigma</strong> – shape (q1, …, qn, r1, …, rm, s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.cosmology.sigma_r">
<span class="sig-prename descclassname"><span class="pre">nnero.cosmology.</span></span><span class="sig-name descname"><span class="pre">sigma_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sharpk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ik_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/cosmology.html#sigma_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.cosmology.sigma_r" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the matter power spectrum inside <cite>radius</cite>.
Note that all physical dimensions must be self consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>-</em>) – shape (s,) or (q1, …, qn, r1, …, rm, s), smoothing scale r in Mpc</p></li>
<li><p><strong>k</strong> (<em>-</em>) – shape (q1, …, qn, p), modes in Mpc^{-1}</p></li>
<li><p><strong>pk</strong> (<em>-</em>) – shape (q1, …, qn, p), power spectrum in Mpc^3</p></li>
<li><p><strong>window</strong> (<em>-</em>) – smoothing function</p></li>
<li><p><strong>ik_radius</strong> (<em>-</em>) – shape of radius, indices of the k array corresponding to k = 1/radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>- smoothed sigma</strong> – shape (q1, …, qn, r1, …, rm, s) or (q1, …, qn, s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nnero.data">
<span id="nnero-data-module"></span><h2>nnero.data module<a class="headerlink" href="#module-nnero.data" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nnero.data.DataPartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">DataPartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">early_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#DataPartition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.DataPartition" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nnero.data.DataPartition.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#DataPartition.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.DataPartition.load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.data.DataPartition.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#DataPartition.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.DataPartition.save" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnero.data.DataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">DataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1994</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#DataSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.DataSet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>DataSet class</p>
</div></blockquote>
<p>compile the data necessary for training</p>
<section id="id3">
<h3>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>file_path: str</dt><dd><p>path to the file that contains the raw data</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>z: np.ndarray</dt><dd><p>array of the redshits of interpolation of the nn</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>frac_test: float</dt><dd><p>fraction of test data out of the total sample</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>frac_valid: float</dt><dd><p>fraction of validation data out of the total sample</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>seed_split: int</dt><dd><p>random seed for data partitioning</p>
</dd>
</dl>
</li>
</ul>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnero.data.MetaData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">MetaData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_min_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_max_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#MetaData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.MetaData" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>MetaData class</p>
</div></blockquote>
<p>metadata that is saved with the neural network for predictions</p>
<dl class="py method">
<dt class="sig sig-object py" id="nnero.data.MetaData.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#MetaData.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.MetaData.load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.data.MetaData.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#MetaData.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.MetaData.save" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nnero.data.TorchDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">TorchDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#TorchDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.TorchDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.data.label_to_plot">
<span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">label_to_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nnero/data.html#label_to_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.label_to_plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.data.preprocess_raw_data">
<span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">preprocess_raw_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1994</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#preprocess_raw_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.preprocess_raw_data" title="Link to this definition"></a></dt>
<dd><p>preprocessing a raw .npz file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.data.true_to_uniform">
<span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">true_to_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#true_to_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.true_to_uniform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.data.uniform_to_true">
<span class="sig-prename descclassname"><span class="pre">nnero.data.</span></span><span class="sig-name descname"><span class="pre">uniform_to_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/data.html#uniform_to_true"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.data.uniform_to_true" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nnero.mcmc">
<span id="nnero-mcmc-module"></span><h2>nnero.mcmc module<a class="headerlink" href="#module-nnero.mcmc" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nnero.mcmc.initialise_walkers">
<span class="sig-prename descclassname"><span class="pre">nnero.mcmc.</span></span><span class="sig-name descname"><span class="pre">initialise_walkers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_walkers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/mcmc.html#initialise_walkers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.mcmc.initialise_walkers" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.mcmc.log_likelihood">
<span class="sig-prename descclassname"><span class="pre">nnero.mcmc.</span></span><span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/nnero/mcmc.html#log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.mcmc.log_likelihood" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.mcmc.log_prior">
<span class="sig-prename descclassname"><span class="pre">nnero.mcmc.</span></span><span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/nnero/mcmc.html#log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.mcmc.log_prior" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>natural logarithm of the prior</p>
</div></blockquote>
<p>assume flat prior except for the parameters for which
a covariance matrix and average value are given</p>
<section id="id4">
<h3>Parameters:<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>theta: (n, d) ndarray</dt><dd><p>parameters
d is the dimension of the vector parameter
n is the number of vector parameter treated at once</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>theta_min: (d) ndarray</dt><dd><p>minimum value of the parameters allowed</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>theta_max:</dt><dd><p>maximum value of the parameters allowed</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="kwargs">
<h3>kwargs:<a class="headerlink" href="#kwargs" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>mask: optional, (d) ndarray</dt><dd><p>where the covariance matrix applies
the mask should have p Trues and d-p False
with p the dimension of the covariance matrix
if cov and my given with dim d then mask still optional</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mu: optional, (p) ndarray</dt><dd><p>average value of the gaussian distribution</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cov: optional, (p, p) ndarray</dt><dd><p>covariance matrix</p>
</dd>
</dl>
</li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.mcmc.log_probability">
<span class="sig-prename descclassname"><span class="pre">nnero.mcmc.</span></span><span class="sig-name descname"><span class="pre">log_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/nnero/mcmc.html#log_probability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.mcmc.log_probability" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nnero.network">
<span id="nnero-network-module"></span><h2>nnero.network module<a class="headerlink" href="#module-nnero.network" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.network.</span></span><span class="sig-name descname"><span class="pre">NeuralNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/network.html#NeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.network.NeuralNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A class wrapping torch.nn.Module for neural network models</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.name" title="Link to this definition"></a></dt>
<dd><p>the name of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.metadata" title="Link to this definition"></a></dt>
<dd><p>metadata on which the model is trained</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metadata</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.partition">
<span class="sig-name descname"><span class="pre">partition</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.partition" title="Link to this definition"></a></dt>
<dd><p>partitioning of the data on which the model is trained</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#nnero.data.DataPartition" title="nnero.data.DataPartition">DataPartition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.train_loss">
<span class="sig-name descname"><span class="pre">train_loss</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.train_loss" title="Link to this definition"></a></dt>
<dd><p>1D array training loss for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.valid_loss">
<span class="sig-name descname"><span class="pre">valid_loss</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.valid_loss" title="Link to this definition"></a></dt>
<dd><p>1D array validation losses for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.train_accuracy">
<span class="sig-name descname"><span class="pre">train_accuracy</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.train_accuracy" title="Link to this definition"></a></dt>
<dd><p>1D array training accuracy for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.valid_accuracy">
<span class="sig-name descname"><span class="pre">valid_accuracy</span></span><a class="headerlink" href="#nnero.network.NeuralNetwork.valid_accuracy" title="Link to this definition"></a></dt>
<dd><p>1D array validation accuracy for each training epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.load_weights_and_extras">
<span class="sig-name descname"><span class="pre">load_weights_and_extras</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nnero/network.html#NeuralNetwork.load_weights_and_extras"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.network.NeuralNetwork.load_weights_and_extras" title="Link to this definition"></a></dt>
<dd><p>loads the network weights and extra information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path to the network to load</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If not all necessary files exists where path points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.print_parameters">
<span class="sig-name descname"><span class="pre">print_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/network.html#NeuralNetwork.print_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.network.NeuralNetwork.print_parameters" title="Link to this definition"></a></dt>
<dd><p>prints the list of parameters in the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_partition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nnero/network.html#NeuralNetwork.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.network.NeuralNetwork.save" title="Link to this definition"></a></dt>
<dd><p>save the neural network model in a bunch of files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – path where to save the neural network
– default is the current directory “.”</p></li>
<li><p><strong>save_partition</strong> (<em>bool</em><em>, </em><em>optional</em>) – if save_partition is false the partitioning of the data into
train, valid and test is not saved (useless for instance once
we have a fully trained model that we just want to use)
– default is True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.network.NeuralNetwork.set_check_metadata_and_partition">
<span class="sig-name descname"><span class="pre">set_check_metadata_and_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nnero/network.html#NeuralNetwork.set_check_metadata_and_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.network.NeuralNetwork.set_check_metadata_and_partition" title="Link to this definition"></a></dt>
<dd><p>set and check the medatada and partition attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><em>DataSet</em></a>) – dataset to compare or to assign to the object</p></li>
<li><p><strong>check_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – option to only compare the compatibility
– default is False</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the dataset is incompatible with the current metadata or partition</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nnero.predictor">
<span id="nnero-predictor-module"></span><h2>nnero.predictor module<a class="headerlink" href="#module-nnero.predictor" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.check_values">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">check_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#check_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.check_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.input_values">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">input_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#input_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.input_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_classifier">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_classifier" title="Link to this definition"></a></dt>
<dd><p>Prediction of the classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> (<em>-</em>) – classifier object already trained</p></li>
<li><p><strong>**kwargs</strong> (<em>-</em>) – <p>any value for a parameter the classifier
has been trained on</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True for an early reionization
False for a late reionization</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>boolean value</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_classifier_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_classifier_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_classifier_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_classifier_numpy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_regressor">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_regressor" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>prediction of the regressor</p>
</div></blockquote>
<section id="id7">
<h3>Parameters:<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>classifier: nnero.Classifier</dt><dd><p>classifier object already trained</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a href="#id8"><span class="problematic" id="id9">**</span></a>kwargs:</dt><dd><p>any value for a parameter the classifier
has been trained on</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id10">
<h3>Returns:<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<p>returns boolean value:
True for an early reionization
False for a late reionization</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_regressor_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_regressor_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_regressor_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_regressor_numpy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_tau">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_tau" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_tau_from_xHII">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_tau_from_xHII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xHII</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_tau_from_xHII"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_tau_from_xHII" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_tau_from_xHII_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_tau_from_xHII_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xHII</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_tau_from_xHII_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_tau_from_xHII_numpy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_tau_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_tau_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_tau_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_tau_numpy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_xHII">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_xHII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_xHII"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_xHII" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.predict_xHII_numpy">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">predict_xHII_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.classifier.Classifier" title="nnero.classifier.Classifier"><span class="pre">Classifier</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#predict_xHII_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.predict_xHII_numpy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.uniform_input_array">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">uniform_input_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#uniform_input_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.uniform_input_array" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.predictor.uniform_input_values">
<span class="sig-prename descclassname"><span class="pre">nnero.predictor.</span></span><span class="sig-name descname"><span class="pre">uniform_input_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.MetaData" title="nnero.data.MetaData"><span class="pre">MetaData</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/predictor.html#uniform_input_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.predictor.uniform_input_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nnero.regressor">
<span id="nnero-regressor-module"></span><h2>nnero.regressor module<a class="headerlink" href="#module-nnero.regressor" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nnero.regressor.Regressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nnero.regressor.</span></span><span class="sig-name descname"><span class="pre">Regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#nnero.network.NeuralNetwork" title="nnero.network.NeuralNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralNetwork</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/gaetanfacchinetti/Documents/work/projects/MatterPS21cm/mps21cm/NNERO/src/nnero/nn_data/DefaultRegressor'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.loss_tau">
<span class="sig-name descname"><span class="pre">loss_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.loss_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.loss_tau" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.loss_xHII">
<span class="sig-name descname"><span class="pre">loss_xHII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.loss_xHII"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.loss_xHII" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.tau_ion">
<span class="sig-name descname"><span class="pre">tau_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.tau_ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.tau_ion" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.test_tau">
<span class="sig-name descname"><span class="pre">test_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.test_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.test_tau" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nnero.regressor.Regressor.test_xHII">
<span class="sig-name descname"><span class="pre">test_xHII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#Regressor.test_xHII"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.Regressor.test_xHII" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nnero.regressor.train_regressor">
<span class="sig-prename descclassname"><span class="pre">nnero.regressor.</span></span><span class="sig-name descname"><span class="pre">train_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.regressor.Regressor" title="nnero.regressor.Regressor"><span class="pre">Regressor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nnero.data.DataSet" title="nnero.data.DataSet"><span class="pre">DataSet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nnero/regressor.html#train_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nnero.regressor.train_regressor" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nnero">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nnero" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="nnero" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Gaétan Facchinetti.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>